<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="计算机网络复习笔记-网络层"><meta name="keywords" content="网络"><meta name="author" content="iLern"><meta name="copyright" content="iLern"><title>计算机网络复习笔记-网络层 | iLern's Blog</title><link rel="shortcut icon" href="/ilern.ico"><link rel="stylesheet" href="/css/index.css?version=1.5.6"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.5.6"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#网络层提供的两种服务"><span class="toc-number">1.</span> <span class="toc-text">网络层提供的两种服务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#网络负责可靠交互"><span class="toc-number">1.1.</span> <span class="toc-text">网络负责可靠交互</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网络负责最大努力交互"><span class="toc-number">1.2.</span> <span class="toc-text">网络负责最大努力交互</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#尽最大努力交付的好处"><span class="toc-number">1.2.1.</span> <span class="toc-text">尽最大努力交付的好处</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#虚电路与数据报的对比"><span class="toc-number">1.3.</span> <span class="toc-text">虚电路与数据报的对比</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IP"><span class="toc-number">2.</span> <span class="toc-text">IP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#配套使用的三个协议"><span class="toc-number">2.1.</span> <span class="toc-text">配套使用的三个协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#中间设备"><span class="toc-number">2.2.</span> <span class="toc-text">中间设备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#虚拟互联网络"><span class="toc-number">2.3.</span> <span class="toc-text">虚拟互联网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IP地址"><span class="toc-number">2.4.</span> <span class="toc-text">IP地址</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#分类"><span class="toc-number">2.4.1.</span> <span class="toc-text">分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#保留"><span class="toc-number">2.4.2.</span> <span class="toc-text">保留</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#私有地址"><span class="toc-number">2.4.3.</span> <span class="toc-text">私有地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#重要特点"><span class="toc-number">2.4.4.</span> <span class="toc-text">重要特点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IP地址与硬件地址"><span class="toc-number">3.</span> <span class="toc-text">IP地址与硬件地址</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#地址解析协议-ARP-Address-Resolution-Protocal"><span class="toc-number">3.1.</span> <span class="toc-text">地址解析协议 ARP Address Resolution Protocal</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IP数据报的格式"><span class="toc-number">4.</span> <span class="toc-text">IP数据报的格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IP数据报分片"><span class="toc-number">5.</span> <span class="toc-text">IP数据报分片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二进制反码求和"><span class="toc-number">6.</span> <span class="toc-text">二进制反码求和</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#转发分组的流程"><span class="toc-number">7.</span> <span class="toc-text">转发分组的流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#特定主机路由"><span class="toc-number">7.1.</span> <span class="toc-text">特定主机路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#默认路由"><span class="toc-number">7.2.</span> <span class="toc-text">默认路由</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#划分子网与构造超网"><span class="toc-number">8.</span> <span class="toc-text">划分子网与构造超网</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#划分子网"><span class="toc-number">8.1.</span> <span class="toc-text">划分子网</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#一个问题"><span class="toc-number">8.1.1.</span> <span class="toc-text">一个问题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#子网掩码"><span class="toc-number">8.2.</span> <span class="toc-text">子网掩码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#构造超网-无分类编址CIDR-路由聚合"><span class="toc-number">8.3.</span> <span class="toc-text">构造超网 无分类编址CIDR 路由聚合</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#构造超网的规则"><span class="toc-number">8.3.1.</span> <span class="toc-text">构造超网的规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#一些问题"><span class="toc-number">8.3.2.</span> <span class="toc-text"> 一些问题</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查找路由表"><span class="toc-number">9.</span> <span class="toc-text">查找路由表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#最长前缀匹配"><span class="toc-number">9.1.</span> <span class="toc-text">最长前缀匹配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二叉线索"><span class="toc-number">9.2.</span> <span class="toc-text">二叉线索</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ICMP"><span class="toc-number">10.</span> <span class="toc-text">ICMP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#格式"><span class="toc-number">10.1.</span> <span class="toc-text">格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ICMP差错报文"><span class="toc-number">10.2.</span> <span class="toc-text">ICMP差错报文</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#不需要发送ICMP差错报文的几种情况"><span class="toc-number">10.2.1.</span> <span class="toc-text">不需要发送ICMP差错报文的几种情况</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#分类-1"><span class="toc-number">10.2.2.</span> <span class="toc-text">分类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ICMP询问报文"><span class="toc-number">10.3.</span> <span class="toc-text">ICMP询问报文</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#分类-2"><span class="toc-number">10.3.1.</span> <span class="toc-text">分类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#源路由"><span class="toc-number">10.4.</span> <span class="toc-text">源路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用"><span class="toc-number">10.5.</span> <span class="toc-text">应用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ping"><span class="toc-number">10.5.1.</span> <span class="toc-text">ping</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#trace-route"><span class="toc-number">10.5.2.</span> <span class="toc-text">trace route</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#路由选择协议"><span class="toc-number">11.</span> <span class="toc-text">路由选择协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#理想的路由算法"><span class="toc-number">11.1.</span> <span class="toc-text">理想的路由算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#分类-3"><span class="toc-number">11.2.</span> <span class="toc-text">分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#分层次的路由选择协议"><span class="toc-number">11.3.</span> <span class="toc-text">分层次的路由选择协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RIP-Route-information-protocol"><span class="toc-number">11.4.</span> <span class="toc-text">RIP Route information protocol</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RIP2报文格式"><span class="toc-number">11.4.1.</span> <span class="toc-text">RIP2报文格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#问题与解决方案"><span class="toc-number">11.4.2.</span> <span class="toc-text">问题与解决方案</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OSPF-Open-Shortest-Path-First"><span class="toc-number">11.5.</span> <span class="toc-text">OSPF Open Shortest Path First</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#三个要点"><span class="toc-number">11.5.1.</span> <span class="toc-text">三个要点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#划分区域"><span class="toc-number">11.5.2.</span> <span class="toc-text">划分区域</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#特点"><span class="toc-number">11.5.3.</span> <span class="toc-text">特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#指定路由器"><span class="toc-number">11.5.4.</span> <span class="toc-text">指定路由器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#分组格式"><span class="toc-number">11.5.5.</span> <span class="toc-text">分组格式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BGP-Border-Gateway-Protocol"><span class="toc-number">11.6.</span> <span class="toc-text">BGP Border Gateway Protocol</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#BGP热土豆路由选择协议"><span class="toc-number">11.6.1.</span> <span class="toc-text">BGP热土豆路由选择协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AS的分类"><span class="toc-number">11.6.2.</span> <span class="toc-text">AS的分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BGP报文"><span class="toc-number">11.6.3.</span> <span class="toc-text">BGP报文</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#一个问题-1"><span class="toc-number">11.6.4.</span> <span class="toc-text"> 一个问题 </span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IP多播"><span class="toc-number">12.</span> <span class="toc-text">IP多播</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#路由器"><span class="toc-number">12.1.</span> <span class="toc-text">路由器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#多播特点"><span class="toc-number">12.2.</span> <span class="toc-text">多播特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IP多播地址与以太网多播地址的转换"><span class="toc-number">12.3.</span> <span class="toc-text">IP多播地址与以太网多播地址的转换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#一个例子"><span class="toc-number">12.3.1.</span> <span class="toc-text"> 一个例子 </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IGMP-Internet-Group-Management-Protocal"><span class="toc-number">12.4.</span> <span class="toc-text">IGMP Internet Group Management Protocal</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#IGMP的本地使用范围"><span class="toc-number">12.4.1.</span> <span class="toc-text">IGMP的本地使用范围</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么多播路由选择协议比单播路由选择协议复杂得多"><span class="toc-number">12.5.</span> <span class="toc-text">为什么多播路由选择协议比单播路由选择协议复杂得多</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IGMP两个阶段及具体措施"><span class="toc-number">12.6.</span> <span class="toc-text">IGMP两个阶段及具体措施</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#第一阶段"><span class="toc-number">12.6.1.</span> <span class="toc-text">第一阶段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#第二阶段"><span class="toc-number">12.6.2.</span> <span class="toc-text">第二阶段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#具体措施"><span class="toc-number">12.6.3.</span> <span class="toc-text">具体措施</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#多播路由选择的三种方法"><span class="toc-number">12.7.</span> <span class="toc-text">多播路由选择的三种方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#洪泛与剪除"><span class="toc-number">12.7.1.</span> <span class="toc-text">洪泛与剪除</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#隧道-lt-第一个隧道-gt"><span class="toc-number">12.7.2.</span> <span class="toc-text">隧道  &lt;第一个隧道&gt; </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#基于核心的发现技术"><span class="toc-number">12.7.3.</span> <span class="toc-text">　基于核心的发现技术</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RPB特点"><span class="toc-number">12.8.</span> <span class="toc-text">RPB特点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VPN-Virtaul-Private-Network"><span class="toc-number">13.</span> <span class="toc-text">VPN Virtaul Private Network</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NAT-Network-Address-Translation"><span class="toc-number">14.</span> <span class="toc-text">NAT Network Address Translation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#NAPT-Network-Address-and-Port-Translation"><span class="toc-number">14.1.</span> <span class="toc-text">NAPT Network Address and Port Translation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MPLS-Multi-Protocol-Label-Switching"><span class="toc-number">15.</span> <span class="toc-text">MPLS Multi Protocol Label Switching</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MPLS特点"><span class="toc-number">15.1.</span> <span class="toc-text">MPLS特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#过程"><span class="toc-number">15.2.</span> <span class="toc-text">过程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MPLS域"><span class="toc-number">15.2.1.</span> <span class="toc-text">MPLS域</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#转发等价类FEC"><span class="toc-number">15.3.</span> <span class="toc-text">转发等价类FEC</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#例子"><span class="toc-number">15.3.1.</span> <span class="toc-text">例子</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MPLS格式"><span class="toc-number">15.4.</span> <span class="toc-text">MPLS格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LSP隧道-lt-第三个隧道-gt"><span class="toc-number">15.5.</span> <span class="toc-text">LSP隧道  &lt;第三个隧道&gt; </span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IPv6"><span class="toc-number">16.</span> <span class="toc-text">IPv6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#主要变化"><span class="toc-number">16.1.</span> <span class="toc-text">主要变化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#一般形式"><span class="toc-number">16.2.</span> <span class="toc-text">一般形式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#地址"><span class="toc-number">16.3.</span> <span class="toc-text">地址</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#特殊地址"><span class="toc-number">16.3.1.</span> <span class="toc-text">特殊地址</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v4-to-v6"><span class="toc-number">16.4.</span> <span class="toc-text">v4 to v6</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://s2.ax1x.com/2019/01/26/knOvb8.png"></div><div class="author-info__name text-center">iLern</div><div class="author-info__description text-center">功名沉浮不必提，稚志初衷别忘记</div><div class="follow-button"><a href="https://github.com/iLern">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">178</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">86</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">20</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" href="http://blog.csdn.net/lyx_2016/article/">lyx</a><a class="author-info-links__name text-center" href="https://oi.men.ci/">Menci</a><a class="author-info-links__name text-center" href="https://5261.github.io">Hellc</a><a class="author-info-links__name text-center" href="https://sulfur6.github.io/">团长</a><a class="author-info-links__name text-center" href="https://yxa0.xyz/">yxa</a><a class="author-info-links__name text-center" href="https://blog.csdn.net/weixin_43618924">LordR</a><a class="author-info-links__name text-center" href="https://blog.csdn.net/Loi_Meiko">MeiCo</a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">iLern's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/about">About</a></span></div><div id="post-info"><div id="post-title">计算机网络复习笔记-网络层</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-11-08</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/计算机网络/">计算机网络</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>内容贼多</p>
<a id="more"></a>
<h2 id="网络层提供的两种服务"><a href="#网络层提供的两种服务" class="headerlink" title="网络层提供的两种服务"></a>网络层提供的两种服务</h2><ul>
<li>网络层向运输层提供服务</li>
<li>网络保证可靠 or 端系统保证可靠</li>
</ul>
<h3 id="网络负责可靠交互"><a href="#网络负责可靠交互" class="headerlink" title="网络负责可靠交互"></a>网络负责可靠交互</h3><ul>
<li>虚电路<ul>
<li>和电路交换类似，都需要建立连接，有电路交换的特点</li>
<li>但是电路交换具有排他性，虚电路没有，所以称为<strong>虚</strong>电路</li>
</ul>
</li>
<li>虚电路建立<strong>逻辑上</strong>的连接，分组沿着逻辑上的连接进行分组转发</li>
</ul>
<h3 id="网络负责最大努力交互"><a href="#网络负责最大努力交互" class="headerlink" title="网络负责最大努力交互"></a>网络负责最大努力交互</h3><ul>
<li><p>因特网真正的设计思路</p>
</li>
<li><p>不提供服务质量的承诺，只进行最大努力、无连接的<strong>数据报服务</strong></p>
<ul>
<li><p>可能出错、丢失、重复、失序</p>
</li>
<li><p>出错由ICMP解决</p>
</li>
</ul>
</li>
</ul>
<h4 id="尽最大努力交付的好处"><a href="#尽最大努力交付的好处" class="headerlink" title="尽最大努力交付的好处"></a>尽最大努力交付的好处</h4><ul>
<li>路由器可以比较简单，价格低廉</li>
<li>运输层负责差错处理、流量控制</li>
<li>网络的造假大大降低，运行方式灵活，能适用多种应用</li>
</ul>
<h3 id="虚电路与数据报的对比"><a href="#虚电路与数据报的对比" class="headerlink" title="虚电路与数据报的对比"></a>虚电路与数据报的对比</h3><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">虚电路</th>
<th style="text-align:center">数据报</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">思路</td>
<td style="text-align:center">网络保证可靠通信</td>
<td style="text-align:center">端系统保证可靠通信</td>
</tr>
<tr>
<td style="text-align:center">连接</td>
<td style="text-align:center">有</td>
<td style="text-align:center">无</td>
</tr>
<tr>
<td style="text-align:center">终点地址</td>
<td style="text-align:center">只有建立连接时使用</td>
<td style="text-align:center">每个分组都有终点的完整地址</td>
</tr>
<tr>
<td style="text-align:center">分组转发</td>
<td style="text-align:center">同一条虚电路的分组按照同一路由进行转发</td>
<td style="text-align:center">每个分组独立选择路由进行转发</td>
</tr>
<tr>
<td style="text-align:center">当节点故障时</td>
<td style="text-align:center">所有通过故障接待您的虚电路均不能工作</td>
<td style="text-align:center">出故障的节点可能会丢失分组，一些路由可能会发生变化</td>
</tr>
<tr>
<td style="text-align:center">分组的顺序</td>
<td style="text-align:center">总是按照顺序到达终点</td>
<td style="text-align:center">到达顺序不一定按照发送顺序</td>
</tr>
<tr>
<td style="text-align:center">差错处理 / 流量控制</td>
<td style="text-align:center">可以由网络负责， 也可以由主机负责</td>
<td style="text-align:center">主机负责</td>
</tr>
</tbody>
</table>
</div>
<h2 id="IP"><a href="#IP" class="headerlink" title="IP"></a>IP</h2><h3 id="配套使用的三个协议"><a href="#配套使用的三个协议" class="headerlink" title="配套使用的三个协议"></a>配套使用的三个协议</h3><ul>
<li>地址解析协议 ARP<ul>
<li>Address Reesolution Protocol</li>
<li>IP地址转换为MAC地址</li>
<li>IP协议族的较下层</li>
</ul>
</li>
<li>网际控制报文协议 ICMP<ul>
<li>Internet Control Message Protocol</li>
<li>控制信息</li>
<li>IP协议族的较上层</li>
</ul>
</li>
<li>忘记组管理协议 IGMP<ul>
<li>Internet Group Management Protocol</li>
<li>实现多播/组播</li>
<li>IP协议族的较上层</li>
</ul>
</li>
</ul>
<h3 id="中间设备"><a href="#中间设备" class="headerlink" title="中间设备"></a>中间设备</h3><ul>
<li>扩展<ul>
<li>转发器 物理层</li>
<li>网桥 数据链路层</li>
</ul>
</li>
<li>互联<ul>
<li>路由器 网络层</li>
<li>桥路器 网桥+ 路由器</li>
<li>网关 网络层以上</li>
</ul>
</li>
</ul>
<h3 id="虚拟互联网络"><a href="#虚拟互联网络" class="headerlink" title="虚拟互联网络"></a>虚拟互联网络</h3><p>又称逻辑互联网络，当互联网上的主机进行通信时，好像在一个网络上通信一样，虽然不同物理网络的异构性客观存在，但是被屏蔽掉了，对于用户而言，只能看到像在同一个网络上通信而看不到异构细节。</p>
<h3 id="IP地址"><a href="#IP地址" class="headerlink" title="IP地址"></a>IP地址</h3><ul>
<li>32位二进制，四个点分十进制数，每个数取值在0 - 255</li>
<li>定义为 网络号+主机号</li>
<li>8位一组</li>
</ul>
<h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4><ul>
<li>A类<ul>
<li>第一位一定是0，前8位（一个字节）表示网络号，后24位表示主机号（三个字节）</li>
<li>一个网络中主机数最多有$2^{24} - 2 = 16777214$</li>
<li>最大网络数$2^7 - 2 = 126$<ul>
<li>全零作为保留地址，意为本网络，不能指派</li>
<li>全一作为环回测试地址，不能指派</li>
</ul>
</li>
<li>前8位 1 - 127</li>
</ul>
</li>
<li>B类<ul>
<li>前两位一定是10，前16位（两个字节）表示网络号，后16位表示主机号（两个字节）</li>
<li>一个网络中主机数最多有$2^{16} - 2 = 65534$</li>
<li>最大网络数$2 ^ {14} = 16384$<ul>
<li>最小网络号为 128.0</li>
<li>二进制为 1000 0000 . 0000 0000</li>
</ul>
</li>
<li>前8位 128 - 191</li>
</ul>
</li>
<li>C类<ul>
<li>前三位一定是110，前24位（三个字节）表示网络号，后8位表示主机号（一个字节)</li>
<li>一个网络中主机数最多有$2^{8} - 2= 254$</li>
<li>最大网络数$2 ^ {21} = 2097152$<ul>
<li>最小网络号为 192.0.0</li>
<li>二进制为 1100 0000 . 0000 0000 . 0000 0000</li>
</ul>
</li>
<li>前8位 192 - 223</li>
</ul>
</li>
<li>D类<ul>
<li>前四位一定是1110，用于多播地址</li>
<li>前8位 224 - 239</li>
</ul>
</li>
<li>E类<ul>
<li>前四位为1111，留作以后使用</li>
<li>前8位 240 - 255</li>
</ul>
</li>
</ul>
<p><img src="IMG_1551.PNG" alt="IMG-1551"></p>
<h4 id="保留"><a href="#保留" class="headerlink" title="保留"></a>保留</h4><p><img src="IMG_1552.PNG" alt="IMG-1552"></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">网络号</th>
<th style="text-align:center">主机号</th>
<th style="text-align:center">用作源地址</th>
<th style="text-align:center">用作目的地址</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">可</td>
<td style="text-align:center">不n可</td>
<td style="text-align:center">本网络的本主机，相当于临时牌照，申请IP地址时使用</td>
</tr>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">host-id</td>
<td style="text-align:center">可</td>
<td style="text-align:center">不可</td>
<td style="text-align:center">本网络的某台主机</td>
</tr>
<tr>
<td style="text-align:center">全1</td>
<td style="text-align:center">全1</td>
<td style="text-align:center">不可</td>
<td style="text-align:center">可</td>
<td style="text-align:center">只在本网络进行广播，所有路由器不进行转发</td>
</tr>
<tr>
<td style="text-align:center">net-id</td>
<td style="text-align:center">全1</td>
<td style="text-align:center">不可</td>
<td style="text-align:center">可</td>
<td style="text-align:center">网络外成员对net-id中的的所有成员进行广播</td>
</tr>
<tr>
<td style="text-align:center">127（0111 1111）</td>
<td style="text-align:center">非全零全一</td>
<td style="text-align:center">可</td>
<td style="text-align:center">可</td>
<td style="text-align:center">本地软件环回测试</td>
</tr>
</tbody>
</table>
</div>
<h4 id="私有地址"><a href="#私有地址" class="headerlink" title="私有地址"></a>私有地址</h4><p>10.0.0.0 ———— 10.255.255.255</p>
<p>(0000 1010 . 0000 0000 . 0000 0000 . 0000 0000 —— 0000 1010 . 1111 1111 . 1111 1111 . 1111 1111)</p>
<p>172.16.0.0 ———— 172.131.255.255</p>
<p>(1010 1100 . 0001 0000 . 0000 0000 . 0000 0000 —— 1010 1100 . 1000 0011 . 1111 1111 . 1111 1111)</p>
<p>192.168.0.0 ———— 192.168.255.255</p>
<p>(1100 0000 . 1010 1000 . 0000 0000 . 0000 0000 —— 1100 0000 . 1010 1000 . 1111 1111 . 1111 1111)</p>
<h4 id="重要特点"><a href="#重要特点" class="headerlink" title="重要特点"></a>重要特点</h4><ul>
<li>分等级<ul>
<li>IP地址管理机构分配IP只分配网络号，主机号由网络号管理单位自行分配</li>
<li>路由器仅仅根据目的主机所连接的网络号来转发分组</li>
<li>这样就可以大大减少路由表的大小</li>
<li>找到了网络，再找主机就很容易了</li>
</ul>
</li>
<li>IP地址标志一个主机 / 路由器 / 链路的接口<ul>
<li>路由器属于不同网络的接口有不同的IP地址</li>
<li>至少有两个不同的IP地址</li>
</ul>
</li>
<li>网桥连接的若干局域网仍拥有相同的网络号，仍属于同一个网络<ul>
<li>网桥 / 转发器仅仅是扩展网络</li>
</ul>
</li>
<li>只包含一段线路的网络不指明IP地址</li>
</ul>
<h2 id="IP地址与硬件地址"><a href="#IP地址与硬件地址" class="headerlink" title="IP地址与硬件地址"></a>IP地址与硬件地址</h2><p>这里说硬件地址而不是MAC地址，因为链路层及以下使用的的硬件地址有很多种，其中以太网使用MAC地址</p>
<p>MAC地址 $\in$ 硬件地址</p>
<ul>
<li>路由器转发不改变IP源和目的，但是改变MAC源和目的<ul>
<li>网桥转发不改变MAC源和目的</li>
<li>路由器转发改变了链路</li>
</ul>
</li>
<li>数据包中间经过的路由器的IP不会出现在IP数据报的首部中</li>
<li>虽然首部有源站，但是路由器<strong>仅根据</strong>目的站的IP的网络号进行转发<ul>
<li>只找到网络就行</li>
</ul>
</li>
</ul>
<h3 id="地址解析协议-ARP-Address-Resolution-Protocal"><a href="#地址解析协议-ARP-Address-Resolution-Protocal" class="headerlink" title="地址解析协议 ARP Address Resolution Protocal"></a>地址解析协议 ARP Address Resolution Protocal</h3><ul>
<li>从网络层使用的IP地址解析出链路层使用的硬件地址</li>
<li>每个主机都有一个ARP Cache，里面有所在<strong>局域网</strong>上的各个主机和路由器的IP地址到硬件地址的映射表<ul>
<li>IP Address；MAC Address；TTL (Time to live) 使用老化策略，过久不使用的地址会被删除</li>
<li>能够减少ARP广播的数量</li>
</ul>
</li>
<li>发送过程<ul>
<li>向本局域网中的主机发送</li>
<li>有就把目的MAC地址写入MAC帧</li>
<li>没有就<strong>本地广播</strong>发送一个<strong>ARP请求分组</strong>，目的主机<strong>响应</strong>，把目的主机的MAC地址加入ARP Cache<ul>
<li><strong>本地广播</strong>：路由器不转发；链路层广播，MAC地址全1</li>
<li><strong>ARP请求分组</strong>：发送方硬件地址 / 发送方IP地址 / 目标方硬件地址 <strong>未知时填零</strong>/ 目标方IP地址；所有主机都会记录下发送方的硬件地址</li>
<li><strong>ARP响应分组</strong>：发送方硬件地址 / 发送方IP地址 / 目标方硬件地址 / 目标方IP地址；是广播实现的一对一通信</li>
</ul>
</li>
<li>如果目的主机和源主机不在同一个局域网，发送主机获得的就不是真正目的主机的MAC地址，而是能通往目的主机的路由器的IP地址。此后发送主机发往目的主机的所有帧，都将发往该路由器，通过它向外发送。这种情况称为委托ARP或<strong>ARP代理（ARP Proxy）</strong>。</li>
</ul>
</li>
<li>为什么不使用硬件地址进行通信<ul>
<li>异构网络很多，互相通信需要进行复杂的地址转换</li>
<li>IP使得所有网络像连接在同一个网络一样，把脏活累活交给ARP去做</li>
</ul>
</li>
</ul>
<h2 id="IP数据报的格式"><a href="#IP数据报的格式" class="headerlink" title="IP数据报的格式"></a>IP数据报的格式</h2><p><img src="IMG_1554.PNG" alt="ip"></p>
<p>首部、数据</p>
<p>首部包括固定部分20字节，可选部分长度不定，总共不超过60字节</p>
<ul>
<li>版本 4位<ul>
<li>0100 IPv4   0110 IPv6</li>
</ul>
</li>
<li>首部长度 4位<ul>
<li>最大表示15个单位，一个单位4字节，所以首部最长60字节</li>
</ul>
</li>
<li>区分服务 8位</li>
<li>总长度 16位<ul>
<li>首部长度 + 数据长度</li>
<li>单位为字节，因此数据报最大长度为$2^{16} - 1 = 65535$字节</li>
<li>总长度不能超过MTU</li>
</ul>
</li>
<li>标识 16位<ul>
<li>长度超过MTU则需要分片</li>
<li>分片后标识来自同一个数据报</li>
</ul>
</li>
<li>标志 3位<ul>
<li>目前只有前两位有意义</li>
<li>最低位是MF（More Fragment），中间一位是DF（Don’t Fragment）<ul>
<li>MF=0 没有分片了</li>
<li>DF=0 允许分片</li>
</ul>
</li>
</ul>
</li>
<li>片偏移 13位<ul>
<li>表示某片在原分组中的相对位置</li>
<li>以8字节为偏移单位，需要乘八，也就是左移三位，正好补上标志部分三位的空缺</li>
</ul>
</li>
<li>生存事件TTL 8位<ul>
<li>每经过一次路由转发，减少一，变成零了还没到目的就丢弃</li>
</ul>
</li>
<li>协议<ul>
<li>指出为谁服务，上层协议是什么</li>
</ul>
</li>
<li>首部检验和  16位<ul>
<li>验证首部在传输中有没有出现差错</li>
<li>二进制反码求和</li>
<li>IP不检验数据部分，扔给链路层做</li>
</ul>
</li>
<li>源地址、目的地址 各32位</li>
<li>可变部分<ul>
<li>最大40字节，需要使长度为4的整数倍，不足则用零填充</li>
<li>其实很少用</li>
</ul>
</li>
</ul>
<h2 id="IP数据报分片"><a href="#IP数据报分片" class="headerlink" title="IP数据报分片"></a>IP数据报分片</h2><p>IP分片不是一件好事情，应该能不分就不分</p>
<ul>
<li><p>分片之后有哪些字段会变</p>
<ul>
<li>总长度</li>
<li>报头检验和</li>
<li>MF位</li>
<li>片偏移</li>
</ul>
</li>
<li><p>分片的坏处</p>
<ul>
<li>效率低</li>
<li>需要缓存</li>
<li>防火墙可能会拦截</li>
</ul>
</li>
</ul>
<h2 id="二进制反码求和"><a href="#二进制反码求和" class="headerlink" title="二进制反码求和"></a>二进制反码求和</h2><ul>
<li>此反码非计组之反码 （ones’ complement）<ul>
<li>计组中的反码 正数的反码是本身 负数的反码是符号位不变，其余位取反</li>
</ul>
</li>
<li>逐位取反之后再相加（再取反）</li>
<li>最高位的进位加在最后一位上 (回卷)<ul>
<li>这样可以使得先加后取反和先取反后加的结果一样</li>
</ul>
</li>
<li>不依赖大端表示 / 小端表示<ul>
<li>交换十六位数的字节顺序，得到的结果相同，只是字节顺序也相应发生变化</li>
</ul>
</li>
</ul>
<h2 id="转发分组的流程"><a href="#转发分组的流程" class="headerlink" title="转发分组的流程"></a>转发分组的流程</h2><h3 id="特定主机路由"><a href="#特定主机路由" class="headerlink" title="特定主机路由"></a>特定主机路由</h3><p>将IP数据报发送到特定的某个主机上，而不是发送到网络上就结束了</p>
<h3 id="默认路由"><a href="#默认路由" class="headerlink" title="默认路由"></a>默认路由</h3><p>路由表中的Default项，不在匹配其他任何项时按照默认路由进行转发</p>
<p>可以减少路由表中的条目数</p>
<h2 id="划分子网与构造超网"><a href="#划分子网与构造超网" class="headerlink" title="划分子网与构造超网"></a>划分子网与构造超网</h2><h3 id="划分子网"><a href="#划分子网" class="headerlink" title="划分子网"></a>划分子网</h3><ul>
<li>网络号、主机号的两级IP 变为网络号、子网号、主机号的三级IP</li>
<li>网络号侵占主机号</li>
<li>因为全零全一不允许使用，每划分一个子网就会废掉两个IP</li>
<li>子网号的位数不能为0、1、15、16<ul>
<li>为0则没有划分子网</li>
<li>为16则没有主机</li>
<li>为1则网络号要么0要么1，不允许使用</li>
<li>为15则主机号要么0要么1，不允许使用</li>
</ul>
</li>
<li>定长子网划分、变长子网划分</li>
</ul>
<h4 id="一个问题"><a href="#一个问题" class="headerlink" title="一个问题"></a><font color="red">一个问题</font></h4><p>一个C类IP，划分为四个子网，分别在全零全一可用 / 不可用的时候损失了多少IP？</p>
<p>四个子网需要两个位的子网号，剩余六个位的主机号</p>
<p>网络号为00， 01， 10， 11，全零全一不可用，只剩下01， 10两个网络</p>
<h3 id="子网掩码"><a href="#子网掩码" class="headerlink" title="子网掩码"></a>子网掩码</h3><ul>
<li>用于找出IP地址中的子网部分</li>
<li>前面为1， 主机号部分为0，与IP做按位与运算，可以去掉主机号</li>
<li>最小IP网络的子网掩码是多少<ul>
<li>255.255.255.252</li>
<li>留出两位作为主机号，00， 01， 10， 11个主机，全零全一不让用，只有两台主机，其中一台是路由器</li>
</ul>
</li>
</ul>
<h3 id="构造超网-无分类编址CIDR-路由聚合"><a href="#构造超网-无分类编址CIDR-路由聚合" class="headerlink" title="构造超网 无分类编址CIDR 路由聚合"></a>构造超网 无分类编址CIDR 路由聚合</h3><p>无分类域间路由选择 Classless Inter-Domain Routing</p>
<ul>
<li>取消了传统ABC类网络，改用网络前缀来代替网络号与子网号<ul>
<li>主机号侵占网络号</li>
</ul>
</li>
<li>又变成两级编址</li>
<li>可以把多个C类网络合并，相当于侵占网络号</li>
<li>使用斜线记法，斜线后面表示网络前缀所占的位数<ul>
<li>数值上对应三级编址中子网掩码的1的位数</li>
</ul>
</li>
<li>仍然使用掩码</li>
<li>路由表中的一个项目可以表示很多传统分类的路由</li>
</ul>
<h4 id="构造超网的规则"><a href="#构造超网的规则" class="headerlink" title="构造超网的规则"></a>构造超网的规则</h4><ul>
<li>构成超网的地址块数必须是$2^n$</li>
<li>构成超网的地址快必须连续</li>
<li>第一个地址的第三字节必须能被块数整除</li>
</ul>
<h4 id="一些问题"><a href="#一些问题" class="headerlink" title=" 一些问题"></a><font color="red"> 一些问题</font></h4><ul>
<li>超网的网络地址能不能是X.Y.33.0？<ul>
<li>X.Y.00100001.0，发现主机号只有最后一个字节，相当于C类网络，没有聚合，也就不能叫超网</li>
</ul>
</li>
<li>X.Y.32.0 能不能确定网络<ul>
<li>X.Y.00100000.0，不能确定主机号的零从哪里开始</li>
<li>必须加上掩码/斜线才能确定网络号</li>
</ul>
</li>
</ul>
<h2 id="查找路由表"><a href="#查找路由表" class="headerlink" title="查找路由表"></a>查找路由表</h2><h3 id="最长前缀匹配"><a href="#最长前缀匹配" class="headerlink" title="最长前缀匹配"></a>最长前缀匹配</h3><p>匹配路由表中最长的那个，因为越长越具体，有特定主机路由就不用网络前缀路由，有网络前缀路由就不用默认路由</p>
<p>路由器取出IP分组中的目的地址，与前缀对应的掩码进行按位与运算提取到网络号，进行匹配</p>
<h3 id="二叉线索"><a href="#二叉线索" class="headerlink" title="二叉线索"></a>二叉线索</h3><p>是一棵Trie</p>
<p>Trie上的前缀是唯一的，进行<strong>唯一前缀匹配</strong></p>
<p>唯一前缀匹配不等价于网络前缀匹配</p>
<h2 id="ICMP"><a href="#ICMP" class="headerlink" title="ICMP"></a>ICMP</h2><p>ICMP在IP之上，ICMP报文作为IP报文的数据部分，也要被封装成IP数据报</p>
<h3 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h3><p>1字节类型，1字节代码，2字节检验和</p>
<p>4字节ICMP数据部分，长度可变</p>
<h3 id="ICMP差错报文"><a href="#ICMP差错报文" class="headerlink" title="ICMP差错报文"></a>ICMP差错报文</h3><p>长度为<strong>36字节</strong></p>
<p>在收到错误的IP数据报后发送，也要封装为IP数据报</p>
<p>（封装后的IP数据报）数据部分是ICMP的前8字节 + 收到的IP数据报的首部 + 8字节，为TCP / UDP的端口号</p>
<p>因为要判定端口不可达</p>
<h4 id="不需要发送ICMP差错报文的几种情况"><a href="#不需要发送ICMP差错报文的几种情况" class="headerlink" title="不需要发送ICMP差错报文的几种情况"></a>不需要发送ICMP差错报文的几种情况</h4><ul>
<li>不再为ICMP差错报文发送ICMP差错报文 / 禁止套娃</li>
<li>只对分片中的第一片发送 / 一个错各个错</li>
<li>多播地址的数据报不发送</li>
<li>特殊地址（127.0.0.0 / 0.0.0.0）不发送</li>
</ul>
<h4 id="分类-1"><a href="#分类-1" class="headerlink" title="分类"></a>分类</h4><ul>
<li>终点不可达<ul>
<li>某一环无法继续传递，向发送方发送终点不可达</li>
<li>报文中的数据表示失败的原因</li>
<li>不可达有五种情况<ul>
<li>网络不可达</li>
<li>主机不可达</li>
<li>协议不可达 //无法向上提交</li>
<li>端口不可达</li>
<li>需要分片但DF位为1</li>
<li>源路由失败</li>
</ul>
</li>
</ul>
</li>
<li>时间超过<ul>
<li>TTL减到0</li>
<li>某些分片迟迟不来，组装出问题</li>
</ul>
</li>
<li>参数问题<ul>
<li>头部参数出错，Pointer部分会指出错误的字节位置</li>
</ul>
</li>
<li>源点抑制<ul>
<li>流量过大，缓存队列溢出，只能丢弃报文，此时发送一个ICMP源点抑制，告知发送方晚点再来</li>
</ul>
</li>
<li>改变路由 / 重定向<ul>
<li>找不到目的地址</li>
</ul>
</li>
</ul>
<h3 id="ICMP询问报文"><a href="#ICMP询问报文" class="headerlink" title="ICMP询问报文"></a>ICMP询问报文</h3><p>长度为<strong>40字节</strong></p>
<h4 id="分类-2"><a href="#分类-2" class="headerlink" title="分类"></a>分类</h4><ul>
<li>回送请求和回答<ul>
<li>ping</li>
</ul>
</li>
<li>时间戳请求和回答<ul>
<li>查询当前时间，提供毫秒级的分辨率</li>
<li>包含三个时间戳 ：Origin时间、Receive时间、transmit时间 （接收方发送回应的时间）</li>
<li>即使不同步也能计算正确的往返时间</li>
</ul>
</li>
</ul>
<h3 id="源路由"><a href="#源路由" class="headerlink" title="源路由"></a>源路由</h3><p>从源路由网桥中提到过，指从源点就确定的路由</p>
<h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><h4 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h4><ul>
<li><strong>ping非常特殊，应用层直接使用网络层，不经过运输层</strong></li>
</ul>
<h4 id="trace-route"><a href="#trace-route" class="headerlink" title="trace route"></a>trace route</h4><ul>
<li><p>发很多次，第一次发TTL是1，第二次发TTL是2，以此类推，每一次路由器都会给出一个超时</p>
</li>
<li><p>当到达目的主机时没法发送超时了，此时设置的一个不可达的UDP端口使得目的主机发送终点不可达</p>
</li>
<li><p>因此<strong>trace route 用到了运输层</strong></p>
</li>
</ul>
<h2 id="路由选择协议"><a href="#路由选择协议" class="headerlink" title="路由选择协议"></a>路由选择协议</h2><h3 id="理想的路由算法"><a href="#理想的路由算法" class="headerlink" title="理想的路由算法"></a>理想的路由算法</h3><ul>
<li>正确、完整</li>
<li>计算上简单</li>
<li>能适应通信量和网络拓扑的变化</li>
<li>稳定性，路由不应该不停变化</li>
<li>公平，除了少数优先级高的用户 / 区分服务</li>
<li>算法应该是最佳的 / 相对概念，特定约束下的较为合理的选择</li>
</ul>
<h3 id="分类-3"><a href="#分类-3" class="headerlink" title="分类"></a>分类</h3><p>静态路由 简单开销小，但是不能及时适应网络状态变化</p>
<p>动态路由 复杂开销大，但是能较好适应网络状态的变化</p>
<p>内部网关协议 IGP AS内部使用</p>
<p>外部网关协议 EGP AS之间使用</p>
<h3 id="分层次的路由选择协议"><a href="#分层次的路由选择协议" class="headerlink" title="分层次的路由选择协议"></a>分层次的路由选择协议</h3><p>Autonomous System 自治系统</p>
<p>把AS内的网络看作一个整体，屏蔽内部细节和采用的路由协议</p>
<p>一个AS对其他AS表现出一个单一的一致的路由选择策略</p>
<h3 id="RIP-Route-information-protocol"><a href="#RIP-Route-information-protocol" class="headerlink" title="RIP Route information protocol"></a>RIP Route information protocol</h3><p>是一种内部网关协议</p>
<p><strong>分布式</strong>的基于<strong>距离向量</strong>的路由选择协议</p>
<p>每经过一个路由器距离加一，距离向量的距离指的是最短距离 / 经过路由器的数目最少</p>
<p>RIP简单粗暴的把距离短的路由认为是好的路由，允许一条路径最多包含15个路由器，距离超过15就标记为不可达</p>
<p><strong>不存在</strong>负载均衡，有两条长度一样的路径也只会走其中一条</p>
<p>工作方式为每隔固定的一段时间和相邻路由器交换自己的路由表</p>
<ul>
<li>三分钟没收到消息就认为不可达，距离设置为16</li>
<li>收到之后总总是要更新，距离可能增大也可能减小，应该以最新的更新</li>
</ul>
<p>能很快收敛 / 所有路由器达到一致</p>
<ul>
<li>路由表一致性不等于路由表表项相同</li>
</ul>
<p>路由表包括目的网络（大方向） 距离 下一跳路由器（小方向）</p>
<h4 id="RIP2报文格式"><a href="#RIP2报文格式" class="headerlink" title="RIP2报文格式"></a>RIP2报文格式</h4><p><img src="IMG_1576.PNG" alt></p>
<p>RIP2要封装到UDP中再封装到IP中，RIP是应用层协议</p>
<p>四字节首部，路由信息20字节，最多25个，总长度最大4 + 20 * 25 = 504字节，超过则启用新的RIP2报文</p>
<p>RIP2和RIP1（最大的）的区别是RIP2支持子网</p>
<p>路由标记表示是否再同一个自治系统中，填写的是自治系统的编码</p>
<h4 id="问题与解决方案"><a href="#问题与解决方案" class="headerlink" title="问题与解决方案"></a>问题与解决方案</h4><ul>
<li>水平分割<ul>
<li>从某个接口学到的路由不会再发回去，防止了路由环路</li>
</ul>
</li>
<li>毒性逆转<ul>
<li>当路由信息变成无效后不是直接删除而是设置为不可达并广播出去，可以清楚路由表中无用的路由</li>
</ul>
</li>
<li>触发更新<ul>
<li>路由信息改变后立即更新并发送给相邻路由器</li>
</ul>
</li>
<li>抑制计时<ul>
<li>如果一条路由更新的跳数大于路由表已记录的该路由的跳数，那么将会引起该路由进入长达180秒（即6个路由更新周期）的抑制状态阶段。在抑制计时器超时前，路由器不再接收关于这条路由的更新信息。可以用来防止路由环路。</li>
</ul>
</li>
</ul>
<h3 id="OSPF-Open-Shortest-Path-First"><a href="#OSPF-Open-Shortest-Path-First" class="headerlink" title="OSPF Open Shortest Path First"></a>OSPF Open Shortest Path First</h3><p>是一种内部网关协议</p>
<p><strong>分布式</strong>的，基于<strong>链路状态</strong>的路由选择协议</p>
<p>工作在网络层，在IP之上，直接使用IP数据报进行传送</p>
<p>使用Djijkstra算法</p>
<p>需要一张完整的网络图，来跑Dijkstra算法</p>
<p>所有的路由器都维护一个完整的链路状态数据库 / 全网的拓扑结构图</p>
<p>所有路由器的数据库都是完全一致的，和RIP中的一致不同</p>
<p>OSPF收敛很快</p>
<h4 id="三个要点"><a href="#三个要点" class="headerlink" title="三个要点"></a>三个要点</h4><ul>
<li>使用泛洪法向自治系统内的所有路由器发送信息</li>
<li>发送与本路由器相邻的所有路由器的链路状态<ul>
<li>与谁相邻，代价是多少</li>
</ul>
</li>
<li>只有链路状态发生变化时，路由器才使用泛洪法向所有路由器发送信息</li>
</ul>
<h4 id="划分区域"><a href="#划分区域" class="headerlink" title="划分区域"></a>划分区域</h4><p>自治系统通常贼大，需要维护的数据库也就会变大，因此在自治系统的基础上进一步划分区域（Area），这样就只需要在区域内泛洪、维护区域的拓扑结构图</p>
<p>每个区域用一个32位的区域标识符来表示，和IP一样使用点分十进制</p>
<p>使用层次结构的区域划分，上层的区域叫做主干区域，标识符为 0.0.0.0，主干区域联通下层区域</p>
<p>位于主干区域中的路由器称为主干路由器（BR）</p>
<p>位于区域边缘，与其他区域通信的路由器称为区域边界路由器（Area Border Router)</p>
<h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ul>
<li>数据报很短<ul>
<li>减少路由信息的通信量，网络最主要的功能还是处理端系统的消息</li>
<li>不必将长的数据报分片传送，有效减少重传</li>
</ul>
</li>
<li>具有多路径负载均衡</li>
<li>具有鉴别功能<ul>
<li>保证了仅在可信的路由器之间交换链路状态信息</li>
</ul>
</li>
<li>支持变长子网划分和CIDR</li>
<li>每一个链路状态都有一个32位的序号，序号增长不超过五秒钟一次</li>
<li>每隔一段时间刷新数据库中的链路状态</li>
<li>互联网规模很大时，OSPF要比RIP好很多，对网络变化的响应很快不存在坏消息传得慢的情况</li>
</ul>
<h4 id="指定路由器"><a href="#指定路由器" class="headerlink" title="指定路由器"></a>指定路由器</h4><p>在一个广播性、多路访问的网络中，如果每个路由器都独立进行链路状态更新包的交换，就会产生巨大流量，不好，因此选举出一个村长来进行链路状态信息的交换。</p>
<p>有DR（Designated Router)）和BDR（Backup Designated Router）</p>
<h4 id="分组格式"><a href="#分组格式" class="headerlink" title="分组格式"></a>分组格式</h4><p><img src="IMG_1577.PNG" alt></p>
<ul>
<li>版本<ul>
<li>当前版本为2，版本一版本二不兼容</li>
</ul>
</li>
<li>类型<ul>
<li>Hello<ul>
<li>每隔十秒交换一次问候分组，从而得知有哪些路由器是可达的</li>
</ul>
</li>
<li>Database Description</li>
<li>Link State Request</li>
<li>Link State Update<ul>
<li>收到更新报文后需要恢复ACK</li>
</ul>
</li>
<li>Link State Acknowledgment</li>
</ul>
</li>
<li>分组长度<ul>
<li>包括OFSF头部的分组长度</li>
</ul>
</li>
<li>路由器ID<ul>
<li>在AS中可以唯一表示路由器</li>
</ul>
</li>
<li>区域ID<ul>
<li>指定分组所属的区域号</li>
</ul>
</li>
<li>校验和<ul>
<li>用于分组所有内容的校验和</li>
</ul>
</li>
<li>鉴别1<ul>
<li>0或1，表示不鉴别和使用口令鉴别</li>
</ul>
</li>
<li>鉴别2<ul>
<li>鉴别1为0时为0，鉴别1为1时为口令</li>
</ul>
</li>
</ul>
<h3 id="BGP-Border-Gateway-Protocol"><a href="#BGP-Border-Gateway-Protocol" class="headerlink" title="BGP Border Gateway Protocol"></a>BGP Border Gateway Protocol</h3><p>外部网关协议</p>
<p>目前版本为4</p>
<p>难以寻找最佳路由，只在AS之间交换可达性信息，找到一条不兜圈子的<strong>比较好</strong>的路由</p>
<p>基于<strong>路径向量</strong>的路由选择协议</p>
<p>每个AS至少要有一个BGP发言人，每个发言人都要属于一个AS</p>
<p>作用于不同AS，但同一个AS中的不同边界路由器也需要建立BGP连接</p>
<p>BGP支持CIDR</p>
<p>是应用层协议，使用TCP进行传输</p>
<ul>
<li>对于远距离的传输，需要使用TCP保证可靠性</li>
</ul>
<h4 id="BGP热土豆路由选择协议"><a href="#BGP热土豆路由选择协议" class="headerlink" title="BGP热土豆路由选择协议"></a>BGP热土豆路由选择协议</h4><p>热马铃薯路由选择（Hot-potato routing）是在当前AS接收到一个数据包后，使其停留在该AS中的时间尽可能短。它尝试减少当前AS的开销，而忽略了网络中其他组成成分的开销。</p>
<p>将分组发给最近的网关路由器，用尽可能最低开销将分组送出其所在 AS。</p>
<h4 id="AS的分类"><a href="#AS的分类" class="headerlink" title="AS的分类"></a>AS的分类</h4><p>单口AS，只有一个连接可以到达另一个AS，只能是信源或信宿</p>
<p>多归路过渡AS，有多个连接到达多个AS，但是拒绝传送流量，只能是信源或信宿 / 拒绝通信量穿越的多归属AS</p>
<p>过渡AS，不允许通信量穿越的多归属AS</p>
<h4 id="BGP报文"><a href="#BGP报文" class="headerlink" title="BGP报文"></a>BGP报文</h4><p>OPEN 与相邻的另一个BGP发言人建立关系 / 打招呼</p>
<p>UPDATE 发送某一路由的信息，列出要撤销的多条路由 / 有新闻</p>
<p>KEEPALIVE  确认打开报文与周期性证实临站关系 / 表明自己还活着 / 只有报文头</p>
<p>NOTIFICATION 发送检测到的差错 / 不跟你玩了</p>
<p><img src="IMG_1579.PNG" alt></p>
<p>标记部分用于鉴别，但是现在没有鉴别方案，全部置为1</p>
<p>长度为包括首部在内的总长度</p>
<p>类型为1-4，上述的四种类型</p>
<h4 id="一个问题-1"><a href="#一个问题-1" class="headerlink" title=" 一个问题 "></a><font color="red"> 一个问题 </font></h4><p><strong>KeepAlive报文在链路层是否需要进行填充？</strong></p>
<p>KeepAlive只有报文头，16 + 2 + 1 = 19 字节</p>
<p>作为TCP的数据部分，需要加上TCP的首部 19 + 20 = 39 字节</p>
<p>作为IP的数据部分，需要加上IP的首部 39 + 20 = 59 字节</p>
<p>MAC帧在长度小于46字节时才进行填充，因此不需要进行填充</p>
<p>以太网最短帧长为64字节，减去16字节头部，4字节FCS，数据部分最短46字节</p>
<h2 id="IP多播"><a href="#IP多播" class="headerlink" title="IP多播"></a>IP多播</h2><h3 id="路由器"><a href="#路由器" class="headerlink" title="路由器"></a>路由器</h3><p>多输入端口，多输出端口</p>
<p>作用是转发分组</p>
<p>路由选择协议生成路由表，路由表生成转发表</p>
<h3 id="多播特点"><a href="#多播特点" class="headerlink" title="多播特点"></a>多播特点</h3><p>使用组地址，D类地址</p>
<p>永久组地址</p>
<p>动态组成员</p>
<p>使用硬件进行多播</p>
<h3 id="IP多播地址与以太网多播地址的转换"><a href="#IP多播地址与以太网多播地址的转换" class="headerlink" title="IP多播地址与以太网多播地址的转换"></a>IP多播地址与以太网多播地址的转换</h3><p>01 + 00 + 5e + 0 + 组播IP低23位</p>
<h4 id="一个例子"><a href="#一个例子" class="headerlink" title=" 一个例子 "></a><font color="red"> 一个例子 </font></h4><p>226.150.47.33</p>
<p>首先确定D类IP，D类IP从224到239</p>
<p>写出后三个字节的二进制</p>
<p>150 = 128 + 16 + 4 + 2 = 1001 0110</p>
<p>47 = 32 + 16 - 1 = 0011 0000 - 1 = 0010 1111</p>
<p>33 = 32 + 1 = 0010 0001</p>
<p>把正数第二字节第一位换成0，因为只要后23位</p>
<p>0001 0110 = 16</p>
<p>0010 1111 = 2F</p>
<p>0010 0001 = 21</p>
<p>最终结果为 01 00 5e 16 2F 21</p>
<h3 id="IGMP-Internet-Group-Management-Protocal"><a href="#IGMP-Internet-Group-Management-Protocal" class="headerlink" title="IGMP Internet Group Management Protocal"></a>IGMP Internet Group Management Protocal</h3><p>使路由器知道多播组成员的信息</p>
<p>看作IP的一个组成部分</p>
<h4 id="IGMP的本地使用范围"><a href="#IGMP的本地使用范围" class="headerlink" title="IGMP的本地使用范围"></a>IGMP的本地使用范围</h4><p><strong>并非</strong> 在因特网范围内对所有多播组成员进行管理的协议</p>
<p>IGMP 不知道IP多播组包含的成员数，也不知道这些成员分布在哪些网络上</p>
<p>IGMP是让连接在本地局域网的多播路由器知道本剧于网上是否有主机参加或退出了多播组</p>
<h3 id="为什么多播路由选择协议比单播路由选择协议复杂得多"><a href="#为什么多播路由选择协议比单播路由选择协议复杂得多" class="headerlink" title="为什么多播路由选择协议比单播路由选择协议复杂得多"></a>为什么多播路由选择协议比单播路由选择协议复杂得多</h3><p>多播转发必须动态适应多播组成员的变化，而单播通常是在网络拓扑发生变化时才需要更新路由</p>
<p>多播路由器在转发多播数据报时，不能仅仅根据多播数据报中的目的地址，还要考虑这个多播数据报从哪里来到哪里去</p>
<p>多播数据报可以从没有加入多播组的主机发出，也可以通过没有组成员接入的网络</p>
<h3 id="IGMP两个阶段及具体措施"><a href="#IGMP两个阶段及具体措施" class="headerlink" title="IGMP两个阶段及具体措施"></a>IGMP两个阶段及具体措施</h3><h4 id="第一阶段"><a href="#第一阶段" class="headerlink" title="第一阶段"></a>第一阶段</h4><p>新主机加入多播组，先向该组的多播地址发送IGMP报文，表明自己要加入，多播路由器收到之后将组成员关系转发到因特网上其他多播路由器，以完善多播路径</p>
<h4 id="第二阶段"><a href="#第二阶段" class="headerlink" title="第二阶段"></a>第二阶段</h4><p>周期性探询本地局域网的主机，确认是否是该组的成员，只要有一个响应认为是活跃的，多次没有响应就不再将组成员关系转发给其他路由器</p>
<h4 id="具体措施"><a href="#具体措施" class="headerlink" title="具体措施"></a>具体措施</h4><p>使用IP多播</p>
<p>探寻组成员关系时对所有组发送一个请求信息的询问报文（而不是每个组一个）</p>
<p>主机收到询问后随机选择一个时延进行发送</p>
<p>如果组内有其他主机发送了，自己就可以不发送了</p>
<h3 id="多播路由选择的三种方法"><a href="#多播路由选择的三种方法" class="headerlink" title="多播路由选择的三种方法"></a>多播路由选择的三种方法</h3><p>多播路由选择实际上是要构建以源主机为根节点的多播转发树</p>
<h4 id="洪泛与剪除"><a href="#洪泛与剪除" class="headerlink" title="洪泛与剪除"></a>洪泛与剪除</h4><p>RBP Reverse Path Broadcasting</p>
<p>洪泛适用于较小的多播组，为了避免兜圈子，使用了反向路径广播Reverse Path Broadcasting的策略</p>
<p>剪除指发现下游树枝上没有多播组成员时，把它和下游树枝一起在转发树上剪除</p>
<h4 id="隧道-lt-第一个隧道-gt"><a href="#隧道-lt-第一个隧道-gt" class="headerlink" title="隧道  &lt;第一个隧道&gt; "></a>隧道 <font color="blue"> &lt;第一个隧道&gt; </font></h4><p>把多播报文封装为单播，使用单播通过不支持多播的网络，出来之后再恢复成多播</p>
<h4 id="基于核心的发现技术"><a href="#基于核心的发现技术" class="headerlink" title="　基于核心的发现技术"></a>　基于核心的发现技术</h4><p>对每一个多播组指定一个核心，核心路由器构建转发树</p>
<h3 id="RPB特点"><a href="#RPB特点" class="headerlink" title="RPB特点"></a>RPB特点</h3><p>路由器收到多播数据报时，先检查它是否是从源点经最短路径传送来的：</p>
<p>若是，就向所有其他方向转发刚才收到的多播数据报（但进入的方向除外 ）</p>
<p>否 则 ， 就 丢 弃 而 不 转 发。</p>
<p>如果 存 在 几 条 同 样 长 度 的 最 短 路 径 ， 那 么 只 能 选 择 一 条 最 短 路 径 ， 选 择 的 准 则 就 是 看 这 几 条 最 短 路 径中的相邻路由器谁的 IP 地址最小。 </p>
<p>最终得出多播转发树，以后就按其转发多播数据报</p>
<h2 id="VPN-Virtaul-Private-Network"><a href="#VPN-Virtaul-Private-Network" class="headerlink" title="VPN Virtaul Private Network"></a>VPN Virtaul Private Network</h2><p>利用公用的互联网作为本机构各专用网之间的通信载体</p>
<p>所有通过互联网传送的数据都必须加密</p>
<p>使用 <strong>隧道技术</strong> 来实现 <font color="blue"> &lt;第二个隧道&gt; </font></p>
<p><img src="IMG_1580.PNG" alt="IMG_1580"></p>
<p>机构内部的VPN为内联网（intranet），不同机构共同建立的VPN为外联网（exrtanet）</p>
<h2 id="NAT-Network-Address-Translation"><a href="#NAT-Network-Address-Translation" class="headerlink" title="NAT Network Address Translation"></a>NAT Network Address Translation</h2><p>专用网中的主机需要与外部进行通信，需要通过NAT路由器将私有地址转换为全球地址</p>
<p>转换结果需要记录在NAT地址转换表中</p>
<p>每次通信需要进行两次转换，离开时一次，进入时一次</p>
<p>对于有$n$个全球IP地址的NAT路由器，最多可以同时有$n$台主机接入到互联网</p>
<p>专用网内部的主机不能作为服务器</p>
<p><img src="IMG_1583.PNG" alt="ING_1583"></p>
<h3 id="NAPT-Network-Address-and-Port-Translation"><a href="#NAPT-Network-Address-and-Port-Translation" class="headerlink" title="NAPT Network Address and Port Translation"></a>NAPT Network Address and Port Translation</h3><p>多个主机公用一个NAT路由器上的全球IP地址</p>
<p>把专用网内部的不同IP地址转换为相同的全球IP地址，源主机采用的TCP端口号不管相不相同都转换为不同的新的端口号</p>
<h2 id="MPLS-Multi-Protocol-Label-Switching"><a href="#MPLS-Multi-Protocol-Label-Switching" class="headerlink" title="MPLS Multi Protocol Label Switching"></a>MPLS Multi Protocol Label Switching</h2><p>属于2.5层协议，是IP的一种增强</p>
<p><strong>多协议</strong> 表示MPLS的上层可以采用多种网络协议、下层可以采用多种链路层协议</p>
<p><strong>标记</strong> 表示每<strong>类</strong>分组被打上一个标记，根据标记对分组进行转发</p>
<font color="red"> **面向连接**</font>



<blockquote>
<p>传统的路由决策，路由器需要对网络数据包进行解包，再根据目的IP地址计算归属的FEC。</p>
<p>而MPLS提出，当网络数据包进入MPLS网络时，对网络数据包进行解包，计算归属的FEC，生成标签（Label）。</p>
<p>当网络数据包在MPLS网络中传输时，路由决策都是基于Label，路由器不再需要对网络数据包进行解包。</p>
</blockquote>
<p>每类分组会有一个特定的编号</p>
<h3 id="MPLS特点"><a href="#MPLS特点" class="headerlink" title="MPLS特点"></a>MPLS特点</h3><ul>
<li>分类意味着面向连接，标记一旦确定，连接的路径就确定了</li>
<li>支持流量工程，平衡网络负载</li>
<li>有效支持VPN</li>
<li>在转发是不上升到第三层查找转发表，而是直接在第二能用硬件进行转发</li>
</ul>
<h3 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h3><ul>
<li>使用LDP label distribution protocol交换报文，找到标记交换路径LSP</li>
<li>分组进入MPLS域时，在入口打上标记，按照转发表将分组发给下一个LSR</li>
<li><font color="red">标记具有强烈的本地意义</font>，仅在两个LSR之间才有意义</li>
<li>分组经过LSR要做两件事情，一是转发，二是标记对换</li>
<li>离开MPLS域时，MPLS出口节点把标记去除</li>
<li>这样的转发方式被称为<strong>显式路由选择</strong></li>
</ul>
<h4 id="MPLS域"><a href="#MPLS域" class="headerlink" title="MPLS域"></a>MPLS域</h4><p>这个区域中所有路由器都支持MPLS技术，都是LSR Label Switching router</p>
<p>LSR既可以标记交换也可以路由选择，转发表被用来构造标记交换表</p>
<h3 id="转发等价类FEC"><a href="#转发等价类FEC" class="headerlink" title="转发等价类FEC"></a>转发等价类FEC</h3><p>如何划分转发等价类是MPLS的核心</p>
<p>转发等价类是LSR按照同样的方式对待的分组的集合</p>
<p>划分方式很灵活，通常由网络管理员来控制</p>
<p>通过设置不同的FEC可以实现负载均衡，也称为流量工程</p>
<h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><p>特定前缀进行匹配</p>
<p>源地址目的地址都相同</p>
<p>某种服务质量需求的（区分服务）</p>
<h3 id="MPLS格式"><a href="#MPLS格式" class="headerlink" title="MPLS格式"></a>MPLS格式</h3><p>在IP数据报被封装成以太网帧之前，先插入一个MPLS首部</p>
<p><img src="IMG_1592.PNG" alt></p>
<p>生存时间用于防止兜圈子</p>
<h3 id="LSP隧道-lt-第三个隧道-gt"><a href="#LSP隧道-lt-第三个隧道-gt" class="headerlink" title="LSP隧道  &lt;第三个隧道&gt; "></a>LSP隧道 <font color="blue"> &lt;第三个隧道&gt; </font></h3><h2 id="IPv6"><a href="#IPv6" class="headerlink" title="IPv6"></a>IPv6</h2><h3 id="主要变化"><a href="#主要变化" class="headerlink" title="主要变化"></a>主要变化</h3><p>允许协议继续扩充</p>
<p>支持即插即用自动配置</p>
<p>支持资源预分配</p>
<p>首部由四字节对齐改为八字节对齐</p>
<h3 id="一般形式"><a href="#一般形式" class="headerlink" title="一般形式"></a>一般形式</h3><p><img src="IMG_1593.PNG" alt></p>
<ul>
<li>版本<ul>
<li>4位，目前版本6</li>
</ul>
</li>
<li>通信量类<ul>
<li>8位，相当于区分服务</li>
</ul>
</li>
<li>流标号</li>
<li>有效载荷长度</li>
<li>下一个首部<ul>
<li>8位，指向扩展首部，串出一个列表</li>
</ul>
</li>
<li>跳数限制<ul>
<li>8位</li>
</ul>
</li>
</ul>
<h3 id="地址"><a href="#地址" class="headerlink" title="地址"></a>地址</h3><p>128位</p>
<p>除Unicast、Multicast外支持Anycast</p>
<ul>
<li>对于一组主机，只要找到最近的一个即可</li>
<li>发向一组，其中只要有一个接收到即可</li>
</ul>
<p>使用冒号十六进制记法</p>
<p>允许把数字前面的0省略</p>
<p>一串零可以使用零压缩压缩成一对冒号，地址中只能压缩一次</p>
<p>CIDR斜线表示法仍然适用</p>
<h4 id="特殊地址"><a href="#特殊地址" class="headerlink" title="特殊地址"></a>特殊地址</h4><p><code>::/128</code> 未指明</p>
<p><code>::1/128</code> 环回</p>
<p><code>FF00::/8</code> 多播</p>
<p><code>FE80::/10</code> 本地链路单播</p>
<h3 id="v4-to-v6"><a href="#v4-to-v6" class="headerlink" title="v4 to v6"></a>v4 to v6</h3><ul>
<li>双协议栈</li>
<li>隧道技术 <font color="blue"> &lt;第四种隧道&gt; </font><ul>
<li>把v6数据报封装进v4数据报</li>
</ul>
</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">iLern</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://ilern.github.io/2020/11/08/计算机网络复习笔记-网络层/">http://ilern.github.io/2020/11/08/计算机网络复习笔记-网络层/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/网络/">网络</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2020/11/11/操作系统学习笔记-内存管理策略/"><i class="fa fa-chevron-left">  </i><span>操作系统学习笔记-内存管理</span></a></div><div class="next-post pull-right"><a href="/2020/10/15/操作系统学习笔记-进程同步/"><span>操作系统学习笔记-进程同步</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2016 - 2022 By iLern</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://ilern.github.io/">blog</a>!</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.6"></script><script src="/js/fancybox.js?version=1.5.6"></script><script src="/js/sidebar.js?version=1.5.6"></script><script src="/js/copy.js?version=1.5.6"></script><script src="/js/fireworks.js?version=1.5.6"></script><script src="/js/transition.js?version=1.5.6"></script><script src="/js/scroll.js?version=1.5.6"></script><script src="/js/head.js?version=1.5.6"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="/js/search/local-search.js"></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>